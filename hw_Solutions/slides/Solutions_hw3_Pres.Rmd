---
title       : Homework 3 Review
subtitle    : 
author      : Daniel Anderson
job         : CourseR
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : zenburn      # 
widgets     : [mathjax]            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
knit        : slidify::knit2slides
--- &twocol
```{r setup, include = FALSE}
knitr::opts_knit$set(root.dir = "/Users/Daniel/Dropbox/Teaching/CourseR/")
```
## 1. Load the Camden Boroughs dataset

```{r}
setwd("/Users/Daniel/Dropbox/Teaching/CourseR/")
d <- read.csv("./data/CamdenBoroughs.csv", na.strings = c("Not applicable", 
	   "Unknown", "999", "NA", ""))
head(d)
```

----
## 2. Create numeric version of `frl`

```{r}
d$frl <- as.numeric(
			sub("%", "", d$Percentage.Claiming.Free.School.Meals)
		)

head(d$frl)
```

---- &twocol
## 3. Notched boxplot

*** =left

```{r, eval = FALSE}
se <- function(x) {
	sqrt(
		var(x, na.rm = TRUE) /
		length(na.omit(x))
	)
}

par(las = 3, cex.axis = 0.75)

plot(d$Town, d$frl, notch = TRUE)

abline(h = mean(d$frl, na.rm = TRUE), 
	col = "blue", lty = 2)
abline(h = mean(d$frl, na.rm = TRUE) + 
	1.96*se(d$frl),
	col = "gray", lty = 2)
abline(h = mean(d$frl, na.rm = TRUE) - 
	1.96*se(d$frl),
	col = "gray", lty = 2)
```

*** =right

```{r, echo = FALSE, warning = FALSE}
se <- function(x) sqrt(var(x, na.rm = TRUE)/length(na.omit(x)))

par(las = 3, cex.axis = 0.75)

plot(d$Town, d$frl, notch = TRUE)
abline(h = mean(d$frl, na.rm = TRUE), col = "blue", lty = 2)
abline(h = mean(d$frl, na.rm = TRUE) + 1.96*se(d$frl),
	col = "gray", lty = 2)
abline(h = mean(d$frl, na.rm = TRUE) - 1.96*se(d$frl),
	col = "gray", lty = 2)
```

----
## 4. Briefly interpret the plot.

*London pretty clearly seems to dominate the data, given that the grand mean
  aligns almost perfectly with the median in London, and the median in all other towns is below the grand mean, with the exception of Camden. Indeed, `r table(d$Town)["London"]` of the `r nrow(d)` observations, or `r paste0(as.character(round(table(d$Town)["London"]/nrow(d) * 100)), "%")` are from London, while 4 of the towns had only one observation. However, of the groups with more than one observation, the proportion of students eligible for free or reduced price lunch was reliably lower than the grand mean, as the upper-bound of the 95% confidence interval around the median for each group was below the grand mean. Outside of London, Edgware had the most variability.*


----
## 5. List of data frames by `Statutory.Low.Age`

```{r}
l <- split(d, d$Statutory.Low.Age)
```

---- &twocol

* Use the list to produce the same plot for schools in which the 
  `Statutory.Low.Age` is 11.

* Produce a boxplot for `frl` by `Local.Authority.Name` for only schools in 
  which the `Statutory.Low.Age` is 3.

*** =left

```{r, warning = FALSE, fig.height = 5}
plot(frl ~ Local.Authority.Name, 
	data = l[["3"]], 
	notch = TRUE,
	main = "Statutory Low Age = 3")
```

*** =right

```{r, warning = FALSE, fig.height = 5}
plot(frl ~ Local.Authority.Name, 
	data = l[["11"]], 
	notch = TRUE,
	main = "Statutory Low Age = 11")
```

---- &twocol
## 6. Multiple Regression Model
* Fit a model for schools in which the Statutory Low Age is 3, with 
  `Number.Of.Boys` and `Local.Authority.Name` modeled as predictors of `frl`. 

* Compute predictor-residual plots for the model (*hint: use a package*).

*** =left

```{r, eval = FALSE}
mod <- lm(frl ~ Number.Of.Boys + 
				Local.Authority.Name, 
		data = d)
library(visreg)
par(mfrow = c(2,1))
visreg(mod)
```

*** =right

```{r, echo = FALSE, fig.height = 6.5}
mod <- lm(frl ~ Number.Of.Boys + Local.Authority.Name, data = d)
library(visreg)
par(mfrow = c(2,1))
visreg(mod)
```

---- &twocol
## 7. Plot Density and Overlay Likelihood

*** =left

```{r, eval = FALSE}
dens <- density(d$frl, na.rm = TRUE)
plot(dens, main = "Density of FRL")
lines(dens$x, 
	  dnorm(dens$x, 
	  	mean(d$frl, na.rm = TRUE), 
	  	sd(d$frl, na.rm = TRUE)), 
	  col = "blue", 
	  lty = 2)
```

*** =right

```{r, echo = FALSE}
dens <- density(d$frl, na.rm = TRUE)
plot(dens, main = "Density of FRL")
lines(dens$x, 
	  dnorm(dens$x, 
	  	mean(d$frl, na.rm = TRUE), 
	  	sd(d$frl, na.rm = TRUE)), 
	  col = "blue", 
	  lty = 2)
```

----
# Do the data appear to have been generated by such a distribution? Why or why not?

<br>

It's difficult to say for sure if the data were generated by the specified
  normal distribution, but it appears somewhat unlikely. The empirical density function has a spike around 0 that is not present in the normal distribution, and the peak of the normal is well above the empirical density function.

